{"ast":null,"code":"import _objectSpread from \"/home/trainode26/Projects/chat-server/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _defineProperty from \"/home/trainode26/Projects/chat-server/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _classCallCheck from \"/home/trainode26/Projects/chat-server/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/trainode26/Projects/chat-server/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/trainode26/Projects/chat-server/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/trainode26/Projects/chat-server/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/trainode26/Projects/chat-server/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _taggedTemplateLiteral from \"/home/trainode26/Projects/chat-server/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";\nvar _jsxFileName = \"/home/trainode26/Projects/chat-server/src/pages/components/CreateUser.jsx\";\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteral([\"\\n  mutation AddUser($name: String!, $email: String!) {\\n    addUser(name: $name, email: $email) {\\n      id\\n      name\\n      email\\n    }\\n  }\\n\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nimport React from 'react';\nimport { Route, Redirect } from 'react-router-dom';\nimport Button from '@material-ui/core/Button';\nimport * as yup from 'yup';\nimport { SnackBarContextConsumer } from '../SnackBarProvider/SnackBarProvider';\nimport TextField from '@material-ui/core/TextField';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport gql from \"graphql-tag\";\nimport { Mutation } from \"react-apollo\";\nvar ADD_USER = gql(_templateObject());\n\nvar CreateUser =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(CreateUser, _React$Component);\n\n  function CreateUser() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, CreateUser);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(CreateUser)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.schema = yup.object().shape({\n      name: yup.string().required('Name is a required field'),\n      email: yup.string().required('Email Address is a required field').email('Email Address must be a valid email')\n    });\n    _this.state = {\n      open: false,\n      showData: false,\n      name: '',\n      email: '',\n      error: {\n        name: '',\n        email: ''\n      },\n      touched: {\n        name: false,\n        email: false\n      }\n    };\n\n    _this.handleClickOpen = function () {\n      _this.setState({\n        open: true\n      });\n    };\n\n    _this.handleClose = function () {\n      _this.setState({\n        open: false,\n        name: '',\n        email: '',\n        touched: {\n          name: false,\n          email: false\n        }\n      });\n    };\n\n    _this.handleSubmit = function (e, addUser, openSnackBar) {\n      localStorage.removeItem(\"loginUser\");\n      e.preventDefault();\n      var _this$state = _this.state,\n          name = _this$state.name,\n          email = _this$state.email;\n      addUser({\n        variables: {\n          name: name,\n          email: email\n        }\n      }).then(function (data) {\n        var _data$data$addUser = data.data.addUser,\n            id = _data$data$addUser.id,\n            name = _data$data$addUser.name,\n            email = _data$data$addUser.email;\n        var value = [id, name, email];\n        localStorage.setItem(\"loginUser\", JSON.stringify(value));\n      }).catch(function (err) {\n        console.log(\"err\", err);\n      });\n      openSnackBar('Data created successfully!', 'success');\n\n      _this.handleClose();\n\n      _this.setState({\n        showData: true\n      });\n    };\n\n    _this.handleChange = function (field) {\n      return function (event) {\n        _this.setState(_defineProperty({}, field, event.target.value), _this.validateForm);\n      };\n    };\n\n    _this.validateForm = function () {\n      var _this$state2 = _this.state,\n          name = _this$state2.name,\n          email = _this$state2.email;\n\n      _this.schema.validate({\n        name: name,\n        email: email\n      }, {\n        abortEarly: false\n      }).then(function () {\n        _this.handleError(null);\n      }).catch(function (err) {\n        _this.handleError(err);\n      });\n    };\n\n    _this.handleError = function (err) {\n      var focussederror = {};\n\n      if (err) {\n        err.inner.forEach(function (element) {\n          focussederror[element.path] = element.message;\n        });\n      }\n\n      _this.setState({\n        error: focussederror\n      });\n    };\n\n    _this.isTouched = function (field) {\n      return function () {\n        var touched = _this.state.touched;\n\n        _this.setState({\n          touched: _objectSpread({}, touched, _defineProperty({}, field, true))\n        }, _this.validateForm);\n      };\n    };\n\n    _this.hasError = function () {\n      var _this$state3 = _this.state,\n          error = _this$state3.error,\n          touched = _this$state3.touched;\n\n      if (!Object.values(error).some(function (item) {\n        return item;\n      }) && Object.values(touched).some(function (item) {\n        return item;\n      })) {\n        return false;\n      }\n\n      return true;\n    };\n\n    _this.getError = function (field) {\n      var _this$state4 = _this.state,\n          touched = _this$state4.touched,\n          error = _this$state4.error;\n\n      if (!touched[field]) {\n        return '';\n      }\n\n      return error[field];\n    };\n\n    return _this;\n  }\n\n  _createClass(CreateUser, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$state5 = this.state,\n          open = _this$state5.open,\n          name = _this$state5.name,\n          email = _this$state5.email,\n          showData = _this$state5.showData;\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 151\n        },\n        __self: this\n      }, React.createElement(Button, {\n        align: \"center\",\n        onClick: this.handleClickOpen,\n        variant: \"contained\",\n        color: \"primary\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 152\n        },\n        __self: this\n      }, \"Start\"), React.createElement(Dialog, {\n        open: open,\n        onClose: this.handleClose,\n        \"aria-labelledby\": \"form-dialog-title\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 155\n        },\n        __self: this\n      }, React.createElement(DialogTitle, {\n        id: \"form-dialog-title\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 160\n        },\n        __self: this\n      }, \" Enter your details:\"), React.createElement(DialogContent, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 161\n        },\n        __self: this\n      }, React.createElement(TextField, {\n        required: true,\n        fullWidth: true,\n        id: \"outlined-name\",\n        label: \"Name\",\n        name: \"name\",\n        value: name,\n        margin: \"normal\",\n        variant: \"outlined\",\n        error: this.getError('name'),\n        helperText: this.getError('name'),\n        onChange: this.handleChange('name'),\n        onBlur: this.isTouched('name'),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 162\n        },\n        __self: this\n      }), React.createElement(TextField, {\n        required: true,\n        fullWidth: true,\n        id: \"outlined-email\",\n        label: \"Email\",\n        name: \"email\",\n        value: email,\n        margin: \"normal\",\n        variant: \"outlined\",\n        error: this.getError('email'),\n        helperText: this.getError('email'),\n        onChange: this.handleChange('email'),\n        onBlur: this.isTouched('email'),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 176\n        },\n        __self: this\n      })), React.createElement(DialogActions, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 191\n        },\n        __self: this\n      }, React.createElement(Button, {\n        variant: \"contained\",\n        onClick: this.handleClose,\n        color: \"primary\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 192\n        },\n        __self: this\n      }, \"Cancel\"), React.createElement(Mutation, {\n        mutation: ADD_USER,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 195\n        },\n        __self: this\n      }, function (addUser, _ref) {\n        var data = _ref.data;\n        return React.createElement(SnackBarContextConsumer, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 197\n          },\n          __self: this\n        }, function (_ref2) {\n          var openSnackBar = _ref2.openSnackBar;\n          return React.createElement(Button, {\n            variant: \"contained\",\n            onClick: function onClick(e) {\n              _this2.handleSubmit(e, addUser, openSnackBar);\n            },\n            color: \"primary\",\n            disabled: _this2.hasError(),\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 199\n            },\n            __self: this\n          }, \"Create\");\n        });\n      }))), showData ? React.createElement(Route, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 212\n        },\n        __self: this\n      }, React.createElement(Redirect, {\n        to: \"/users\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 212\n        },\n        __self: this\n      })) : '');\n    }\n  }]);\n\n  return CreateUser;\n}(React.Component);\n\nexport default CreateUser;","map":{"version":3,"sources":["/home/trainode26/Projects/chat-server/src/pages/components/CreateUser.jsx"],"names":["React","Route","Redirect","Button","yup","SnackBarContextConsumer","TextField","Dialog","DialogActions","DialogContent","DialogTitle","gql","Mutation","ADD_USER","CreateUser","schema","object","shape","name","string","required","email","state","open","showData","error","touched","handleClickOpen","setState","handleClose","handleSubmit","e","addUser","openSnackBar","localStorage","removeItem","preventDefault","variables","then","data","id","value","setItem","JSON","stringify","catch","err","console","log","handleChange","field","event","target","validateForm","validate","abortEarly","handleError","focussederror","inner","forEach","element","path","message","isTouched","hasError","Object","values","some","item","getError","Component"],"mappings":";;;;;;;;;;;;;;;;;;;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,KAAT,EAAgBC,QAAhB,QAAgC,kBAAhC;AACA,OAAOC,MAAP,MAAmB,0BAAnB;AACA,OAAO,KAAKC,GAAZ,MAAqB,KAArB;AACA,SAASC,uBAAT,QAAwC,sCAAxC;AACA,OAAOC,SAAP,MAAsB,6BAAtB;AACA,OAAOC,MAAP,MAAmB,0BAAnB;AACA,OAAOC,aAAP,MAA0B,iCAA1B;AACA,OAAOC,aAAP,MAA0B,iCAA1B;AACA,OAAOC,WAAP,MAAwB,+BAAxB;AACA,OAAOC,GAAP,MAAgB,aAAhB;AACA,SAASC,QAAT,QAAyB,cAAzB;AAEA,IAAMC,QAAQ,GAAGF,GAAH,mBAAd;;IAUMG,U;;;;;;;;;;;;;;;;;UACJC,M,GAASX,GAAG,CAACY,MAAJ,GAAaC,KAAb,CAAmB;AAC1BC,MAAAA,IAAI,EAAEd,GAAG,CAACe,MAAJ,GAAaC,QAAb,CAAsB,0BAAtB,CADoB;AAE1BC,MAAAA,KAAK,EAAEjB,GAAG,CAACe,MAAJ,GAAaC,QAAb,CAAsB,mCAAtB,EAA2DC,KAA3D,CAAiE,qCAAjE;AAFmB,KAAnB,C;UAKTC,K,GAAQ;AACNC,MAAAA,IAAI,EAAE,KADA;AAENC,MAAAA,QAAQ,EAAE,KAFJ;AAGNN,MAAAA,IAAI,EAAE,EAHA;AAING,MAAAA,KAAK,EAAE,EAJD;AAKNI,MAAAA,KAAK,EAAE;AACLP,QAAAA,IAAI,EAAE,EADD;AAELG,QAAAA,KAAK,EAAE;AAFF,OALD;AASNK,MAAAA,OAAO,EAAE;AACPR,QAAAA,IAAI,EAAE,KADC;AAEPG,QAAAA,KAAK,EAAE;AAFA;AATH,K;;UAeRM,e,GAAkB,YAAM;AACtB,YAAKC,QAAL,CAAc;AAAEL,QAAAA,IAAI,EAAE;AAAR,OAAd;AACD,K;;UAEDM,W,GAAc,YAAM;AAClB,YAAKD,QAAL,CAAc;AACZL,QAAAA,IAAI,EAAE,KADM;AAEZL,QAAAA,IAAI,EAAE,EAFM;AAGZG,QAAAA,KAAK,EAAE,EAHK;AAIZK,QAAAA,OAAO,EAAE;AACPR,UAAAA,IAAI,EAAE,KADC;AAEPG,UAAAA,KAAK,EAAE;AAFA;AAJG,OAAd;AASD,K;;UAEDS,Y,GAAe,UAACC,CAAD,EAAIC,OAAJ,EAAaC,YAAb,EAA8B;AAC3CC,MAAAA,YAAY,CAACC,UAAb,CAAwB,WAAxB;AACAJ,MAAAA,CAAC,CAACK,cAAF;AAF2C,wBAGnB,MAAKd,KAHc;AAAA,UAGnCJ,IAHmC,eAGnCA,IAHmC;AAAA,UAG7BG,KAH6B,eAG7BA,KAH6B;AAI3CW,MAAAA,OAAO,CAAC;AAAEK,QAAAA,SAAS,EAAE;AAAEnB,UAAAA,IAAI,EAAJA,IAAF;AAAQG,UAAAA,KAAK,EAALA;AAAR;AAAb,OAAD,CAAP,CAAuCiB,IAAvC,CAA4C,UAACC,IAAD,EAAU;AAAA,iCACxBA,IAAI,CAACA,IAAL,CAAUP,OADc;AAAA,YAC5CQ,EAD4C,sBAC5CA,EAD4C;AAAA,YACxCtB,IADwC,sBACxCA,IADwC;AAAA,YAClCG,KADkC,sBAClCA,KADkC;AAEpD,YAAMoB,KAAK,GAAG,CAACD,EAAD,EAAKtB,IAAL,EAAWG,KAAX,CAAd;AACAa,QAAAA,YAAY,CAACQ,OAAb,CAAqB,WAArB,EAAkCC,IAAI,CAACC,SAAL,CAAeH,KAAf,CAAlC;AACD,OAJD,EAKCI,KALD,CAKO,UAAAC,GAAG,EAAI;AACZC,QAAAA,OAAO,CAACC,GAAR,CAAY,KAAZ,EAAmBF,GAAnB;AACD,OAPD;AAQAb,MAAAA,YAAY,CAAC,4BAAD,EAA+B,SAA/B,CAAZ;;AACA,YAAKJ,WAAL;;AACA,YAAKD,QAAL,CAAc;AACZJ,QAAAA,QAAQ,EAAE;AADE,OAAd;AAID,K;;UAEDyB,Y,GAAe,UAAAC,KAAK;AAAA,aAAI,UAACC,KAAD,EAAW;AACjC,cAAKvB,QAAL,qBACGsB,KADH,EACWC,KAAK,CAACC,MAAN,CAAaX,KADxB,GAEG,MAAKY,YAFR;AAGD,OAJmB;AAAA,K;;UAMpBA,Y,GAAe,YAAM;AAAA,yBAIf,MAAK/B,KAJU;AAAA,UAEjBJ,IAFiB,gBAEjBA,IAFiB;AAAA,UAGjBG,KAHiB,gBAGjBA,KAHiB;;AAKnB,YAAKN,MAAL,CACGuC,QADH,CACY;AACRpC,QAAAA,IAAI,EAAJA,IADQ;AACFG,QAAAA,KAAK,EAALA;AADE,OADZ,EAGK;AAAEkC,QAAAA,UAAU,EAAE;AAAd,OAHL,EAIGjB,IAJH,CAIQ,YAAM;AACV,cAAKkB,WAAL,CAAiB,IAAjB;AACD,OANH,EAOGX,KAPH,CAOS,UAACC,GAAD,EAAS;AACd,cAAKU,WAAL,CAAiBV,GAAjB;AACD,OATH;AAUD,K;;UAEDU,W,GAAc,UAACV,GAAD,EAAS;AACrB,UAAMW,aAAa,GAAG,EAAtB;;AACA,UAAIX,GAAJ,EAAS;AACPA,QAAAA,GAAG,CAACY,KAAJ,CAAUC,OAAV,CAAkB,UAACC,OAAD,EAAa;AAC7BH,UAAAA,aAAa,CAACG,OAAO,CAACC,IAAT,CAAb,GAA8BD,OAAO,CAACE,OAAtC;AACD,SAFD;AAGD;;AACD,YAAKlC,QAAL,CAAc;AACZH,QAAAA,KAAK,EAAEgC;AADK,OAAd;AAGD,K;;UAEDM,S,GAAY,UAAAb,KAAK;AAAA,aAAI,YAAM;AAAA,YAEvBxB,OAFuB,GAGrB,MAAKJ,KAHgB,CAEvBI,OAFuB;;AAIzB,cAAKE,QAAL,CAAc;AACZF,UAAAA,OAAO,oBAAOA,OAAP,sBAAiBwB,KAAjB,EAAyB,IAAzB;AADK,SAAd,EAEG,MAAKG,YAFR;AAGD,OAPgB;AAAA,K;;UASjBW,Q,GAAW,YAAM;AAAA,yBAIX,MAAK1C,KAJM;AAAA,UAEbG,KAFa,gBAEbA,KAFa;AAAA,UAGbC,OAHa,gBAGbA,OAHa;;AAKf,UAAI,CAACuC,MAAM,CAACC,MAAP,CAAczC,KAAd,EAAqB0C,IAArB,CAA0B,UAAAC,IAAI;AAAA,eAAIA,IAAJ;AAAA,OAA9B,CAAD,IACDH,MAAM,CAACC,MAAP,CAAcxC,OAAd,EAAuByC,IAAvB,CAA4B,UAAAC,IAAI;AAAA,eAAIA,IAAJ;AAAA,OAAhC,CADH,EAEE;AACA,eAAO,KAAP;AACD;;AACD,aAAO,IAAP;AACD,K;;UAEDC,Q,GAAW,UAACnB,KAAD,EAAW;AAAA,yBAGhB,MAAK5B,KAHW;AAAA,UAElBI,OAFkB,gBAElBA,OAFkB;AAAA,UAETD,KAFS,gBAETA,KAFS;;AAIpB,UAAI,CAACC,OAAO,CAACwB,KAAD,CAAZ,EAAqB;AACnB,eAAO,EAAP;AACD;;AACD,aAAOzB,KAAK,CAACyB,KAAD,CAAZ;AACD,K;;;;;;;6BAEQ;AAAA;;AAAA,yBACiC,KAAK5B,KADtC;AAAA,UACCC,IADD,gBACCA,IADD;AAAA,UACOL,IADP,gBACOA,IADP;AAAA,UACaG,KADb,gBACaA,KADb;AAAA,UACoBG,QADpB,gBACoBA,QADpB;AAEP,aACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,oBAAC,MAAD;AAAQ,QAAA,KAAK,EAAC,QAAd;AAAuB,QAAA,OAAO,EAAE,KAAKG,eAArC;AAAsD,QAAA,OAAO,EAAC,WAA9D;AAA0E,QAAA,KAAK,EAAC,SAAhF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBADF,EAIE,oBAAC,MAAD;AACE,QAAA,IAAI,EAAEJ,IADR;AAEE,QAAA,OAAO,EAAE,KAAKM,WAFhB;AAGE,2BAAgB,mBAHlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAKE,oBAAC,WAAD;AAAa,QAAA,EAAE,EAAC,mBAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gCALF,EAME,oBAAC,aAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,oBAAC,SAAD;AACE,QAAA,QAAQ,MADV;AAEE,QAAA,SAAS,MAFX;AAGE,QAAA,EAAE,EAAC,eAHL;AAIE,QAAA,KAAK,EAAC,MAJR;AAKE,QAAA,IAAI,EAAC,MALP;AAME,QAAA,KAAK,EAAEX,IANT;AAOE,QAAA,MAAM,EAAC,QAPT;AAQE,QAAA,OAAO,EAAC,UARV;AASE,QAAA,KAAK,EAAE,KAAKmD,QAAL,CAAc,MAAd,CATT;AAUE,QAAA,UAAU,EAAE,KAAKA,QAAL,CAAc,MAAd,CAVd;AAWE,QAAA,QAAQ,EAAE,KAAKpB,YAAL,CAAkB,MAAlB,CAXZ;AAYE,QAAA,MAAM,EAAE,KAAKc,SAAL,CAAe,MAAf,CAZV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF,EAeE,oBAAC,SAAD;AACE,QAAA,QAAQ,MADV;AAEE,QAAA,SAAS,MAFX;AAGE,QAAA,EAAE,EAAC,gBAHL;AAIE,QAAA,KAAK,EAAC,OAJR;AAKE,QAAA,IAAI,EAAC,OALP;AAME,QAAA,KAAK,EAAE1C,KANT;AAOE,QAAA,MAAM,EAAC,QAPT;AAQE,QAAA,OAAO,EAAC,UARV;AASE,QAAA,KAAK,EAAE,KAAKgD,QAAL,CAAc,OAAd,CATT;AAUE,QAAA,UAAU,EAAE,KAAKA,QAAL,CAAc,OAAd,CAVd;AAWE,QAAA,QAAQ,EAAE,KAAKpB,YAAL,CAAkB,OAAlB,CAXZ;AAYE,QAAA,MAAM,EAAE,KAAKc,SAAL,CAAe,OAAf,CAZV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAfF,CANF,EAoCE,oBAAC,aAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,oBAAC,MAAD;AAAQ,QAAA,OAAO,EAAC,WAAhB;AAA4B,QAAA,OAAO,EAAE,KAAKlC,WAA1C;AAAuD,QAAA,KAAK,EAAC,SAA7D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADF,EAII,oBAAC,QAAD;AAAU,QAAA,QAAQ,EAAEhB,QAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACG,UAACmB,OAAD;AAAA,YAAWO,IAAX,QAAWA,IAAX;AAAA,eACC,oBAAC,uBAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACG;AAAA,cAAGN,YAAH,SAAGA,YAAH;AAAA,iBACC,oBAAC,MAAD;AAAQ,YAAA,OAAO,EAAC,WAAhB;AACE,YAAA,OAAO,EAAE,iBAACF,CAAD,EAAO;AAAC,cAAA,MAAI,CAACD,YAAL,CAAkBC,CAAlB,EAAqBC,OAArB,EAA8BC,YAA9B;AAA4C,aAD/D;AAEE,YAAA,KAAK,EAAC,SAFR;AAGE,YAAA,QAAQ,EAAE,MAAI,CAAC+B,QAAL,EAHZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBADD;AAAA,SADH,CADD;AAAA,OADH,CAJJ,CApCF,CAJF,EA6DGxC,QAAQ,GAAI,oBAAC,KAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAO,oBAAC,QAAD;AAAU,QAAA,EAAE,EAAC,QAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAAP,CAAJ,GAA8C,EA7DzD,CADF;AAiED;;;;EA/LsBxB,KAAK,CAACsE,S;;AAkM/B,eAAexD,UAAf","sourcesContent":["import React from 'react';\nimport { Route, Redirect } from 'react-router-dom';\nimport Button from '@material-ui/core/Button';\nimport * as yup from 'yup';\nimport { SnackBarContextConsumer } from '../SnackBarProvider/SnackBarProvider';\nimport TextField from '@material-ui/core/TextField';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport gql from \"graphql-tag\";\nimport { Mutation } from \"react-apollo\";\n\nconst ADD_USER = gql`\n  mutation AddUser($name: String!, $email: String!) {\n    addUser(name: $name, email: $email) {\n      id\n      name\n      email\n    }\n  }\n`;\n\nclass CreateUser extends React.Component {\n  schema = yup.object().shape({\n    name: yup.string().required('Name is a required field'),\n    email: yup.string().required('Email Address is a required field').email('Email Address must be a valid email'),\n  });\n\n  state = {\n    open: false,\n    showData: false,\n    name: '',\n    email: '',\n    error: {\n      name: '',\n      email: '',\n    },\n    touched: {\n      name: false,\n      email: false,\n    },\n  };\n\n  handleClickOpen = () => {\n    this.setState({ open: true });\n  };\n\n  handleClose = () => {\n    this.setState({ \n      open: false,\n      name: '',\n      email: '',\n      touched: {\n        name: false,\n        email: false,\n      },\n    });\n  }  \n\n  handleSubmit = (e, addUser, openSnackBar) => {\n    localStorage.removeItem(\"loginUser\");\n    e.preventDefault();\n    const { name, email } = this.state;\n    addUser({ variables: { name, email }}).then((data) => {\n      const { id, name, email } = data.data.addUser\n      const value = [id, name, email]\n      localStorage.setItem(\"loginUser\", JSON.stringify(value));\n    })\n    .catch(err => {\n      console.log(\"err\", err)\n    });\n    openSnackBar('Data created successfully!', 'success');\n    this.handleClose();\n    this.setState({\n      showData: true,\n    });\n\n  }  \n\n  handleChange = field => (event) => {\n    this.setState({\n      [field]: event.target.value,\n    }, this.validateForm);\n  }\n\n  validateForm = () => {\n    const {\n      name,\n      email,\n    } = this.state;\n    this.schema\n      .validate({\n        name, email,\n      }, { abortEarly: false })\n      .then(() => {\n        this.handleError(null);\n      })\n      .catch((err) => {\n        this.handleError(err);\n      });\n  }\n\n  handleError = (err) => {\n    const focussederror = {};\n    if (err) {\n      err.inner.forEach((element) => {\n        focussederror[element.path] = element.message;\n      });\n    }\n    this.setState({\n      error: focussederror,\n    });\n  }\n\n  isTouched = field => () => {\n    const {\n      touched,\n    } = this.state;\n    this.setState({\n      touched: { ...touched, [field]: true },\n    }, this.validateForm);\n  }\n\n  hasError = () => {\n    const {\n      error,\n      touched,\n    } = this.state;\n    if (!Object.values(error).some(item => item)\n    && Object.values(touched).some(item => item)\n    ) {\n      return false;\n    }\n    return true;\n  }\n\n  getError = (field) => {\n    const {\n      touched, error,\n    } = this.state;\n    if (!touched[field]) {\n      return '';\n    }\n    return error[field];\n  }\n\n  render() {\n    const { open, name, email, showData } = this.state;\n    return (\n      <div>\n        <Button align=\"center\" onClick={this.handleClickOpen} variant=\"contained\" color=\"primary\">\n          Start\n        </Button>\n        <Dialog\n          open={open}\n          onClose={this.handleClose}\n          aria-labelledby=\"form-dialog-title\"\n        >\n          <DialogTitle id=\"form-dialog-title\"> Enter your details:</DialogTitle>\n          <DialogContent>\n            <TextField\n              required\n              fullWidth\n              id=\"outlined-name\"\n              label=\"Name\"\n              name=\"name\"\n              value={name}\n              margin=\"normal\"\n              variant=\"outlined\"\n              error={this.getError('name')}\n              helperText={this.getError('name')}\n              onChange={this.handleChange('name')}\n              onBlur={this.isTouched('name')}\n            />\n            <TextField\n              required\n              fullWidth\n              id=\"outlined-email\"\n              label=\"Email\"\n              name=\"email\"\n              value={email}\n              margin=\"normal\"\n              variant=\"outlined\"\n              error={this.getError('email')}\n              helperText={this.getError('email')}\n              onChange={this.handleChange('email')}\n              onBlur={this.isTouched('email')}\n            />\n          </DialogContent>\n          <DialogActions>\n            <Button variant='contained' onClick={this.handleClose} color=\"primary\">\n              Cancel\n            </Button>\n              <Mutation mutation={ADD_USER}>\n                {(addUser, {data}) => (\n                  <SnackBarContextConsumer>\n                    {({ openSnackBar }) => (\n                      <Button variant='contained' \n                        onClick={(e) => {this.handleSubmit(e, addUser, openSnackBar)}}\n                        color=\"primary\"\n                        disabled={this.hasError()}\n                      >\n                        Create\n                      </Button>\n                    )}\n                  </SnackBarContextConsumer>\n                )}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            \n              </Mutation>\n          </DialogActions>\n        </Dialog>\n        {showData ?  <Route><Redirect to=\"/users\" /></Route> : ''}\n      </div>\n    );\n  }\n}\n\nexport default CreateUser;"]},"metadata":{},"sourceType":"module"}